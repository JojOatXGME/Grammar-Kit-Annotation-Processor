Grammar-Kit Annotation Processor
================================

Proof of concept for running Grammar-Kit as an annotation processor. See
[issue #3] and [issue #23] of the [gradle-grammar-kit-plugin].

How to use
----------

```groovy
def bnfFiles = files('src/main/lang/Sample.bnf')

repositories {
  maven { url 'https://github.com/JojOatXGME/Grammar-Kit-Annotation-Processor/raw/maven-repository' }
  // Copied from GrammarKit.groovy in gradle-grammar-kit-plugin.
  // https://github.com/JetBrains/gradle-grammar-kit-plugin/blob/74357beb863e910515a0843293f11a0cbb16623e/src/main/groovy/org/jetbrains/grammarkit/GrammarKit.groovy#L12-L16
  maven { url "https://cache-redirector.jetbrains.com/intellij-dependencies" }
  maven { url "https://www.jetbrains.com/intellij-repository/releases" }
  maven { url 'https://www.jitpack.io' }
}

dependencies {
    annotationProcessor 'dev.johanness:grammar-kit-annotation-processor:0.1.0'
}

compileJava {
    inputs.files bnfFiles
    options.compilerArgs += ["-Aparser=${bnfFiles.asPath}"]
}
```

Limitations
-----------

* Generation of lexers with JFlex is currently not supported.

* If the class behind `psiImplUtilClass` uses types which are generated
  by an annotation processor, these types might not be transferred
  correctly to the classes generated by Grammar-Kit. Specifically, this
  issue affects only generic types and types imported with wildcards. To
  fix this issues, Grammar-Kit would need to provide the names of all
  classes it is about to generate before it generates them.

* Implementation depends on internals of Grammar-Kit through reflection
  because Grammar-Kit does have a tooling API which allows for
  dependency injection regarding the internal `JavaHelper` class.

* Errors and warnings from Grammar-Kit are not reported to the compiler
  because Grammar-Kit does not allow for dependency injection regarding
  the handling of diagnostics.

[gradle-grammar-kit-plugin]:
<https://github.com/JetBrains/gradle-grammar-kit-plugin>
"JetBrains/gradle-grammar-kit-plugin: Gradle plugin for generating lexers (with JFlex) and BNF parsers (with Grammar-Kit) for IntelliJ language plugins"
[issue #3]:
<https://github.com/JetBrains/gradle-grammar-kit-plugin/issues/3>
"Code generation isn&#39;t equal with Grammar-Kit 路 Issue #3 路 JetBrains/gradle-grammar-kit-plugin"
[issue #23]:
<https://github.com/JetBrains/gradle-grammar-kit-plugin/issues/23>
"ImplUtil class not found 路 Issue #23 路 JetBrains/gradle-grammar-kit-plugin"
